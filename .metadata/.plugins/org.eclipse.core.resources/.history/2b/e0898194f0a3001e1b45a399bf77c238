package com.bank.customer.serviceImpl;

import java.util.List;
import java.util.Optional;
import java.util.UUID;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.bank.customer.entity.Customer;
import com.bank.customer.repository.CustomerRepository;
import com.bank.customer.service.CustomerService;

@Service
public class CustomerServiceImpl implements CustomerService{

	@Autowired
	private CustomerRepository customerRepository;
	
	@Override
	public Customer createCustomer(Customer customer) {
		customer.setAccountNumber(UUID.randomUUID().toString());
		customer.setUserName(customer.getFirstName() + "_" + customer.getLastName());
		Customer createdCustomer = customerRepository.save(customer);
		// perform any data hiding functions here and then send back the customer object
		return createdCustomer;
	}

	@Override
	public String deleteCustomer(String userName) {
		customerRepository.deleteById(userName);
		return "Customer deleted successfully";
	}

	@Override
	public String updateCustomer(Customer updatedCustomer) {
		Optional<Customer> customer = customerRepository.findById(updatedCustomer.getUserName());
		if(customer.isPresent()) {
			Customer existingCustomer = customer.get();
			existingCustomer.setAddress(updatedCustomer.getAddress());
			existingCustomer.setEmail(updatedCustomer.getEmail());
			existingCustomer.setFirstName(updatedCustomer.getFirstName());
			existingCustomer.setLastName(updatedCustomer.getLastName());
			existingCustomer.setMobile(updatedCustomer.getMobile());
			existingCustomer.setPassword(updatedCustomer.getPassword());
			existingCustomer.setRole(updatedCustomer.getRole());
			
			customerRepository.save(existingCustomer);
			return "Customer details updated successfully !";
		}
		return "The given customer is not present, please create a new customer.";
	}

	@Override
	public Customer viewCustomer(String userName) {
		Optional<Customer> customer = customerRepository.findById(userName);
		// implement custome exception throwing if the customer is not present
		// check it by using isPresent() method
		// extra part
		return customer.get();
	}

	@Override
	public List<Customer> viewAllCustomers() {
		// TODO Auto-generated method stub
		return null;
	}
	
	

}
